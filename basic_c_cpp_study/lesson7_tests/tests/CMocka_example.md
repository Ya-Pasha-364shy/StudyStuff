библиотека CMocka - это прекрасный фреймворк для тестирования приложений на языке Си.

url: https://cmoka.org

install: `sudo apt install libcmoka-dev`

compile and run: `gcc tests.c -lcmoka && ./a.out`

на MacOS лучше собрать из исходников.

Описание: иногда функция вызывает что-то сторонее, но нам не нужно тестировать стороние функции из других библиотек. Например, открытие файла, чтение из файла и прочее. В таких случаях нам на помощь приходят моки (`mocks`).

CMocka позволяет подменить функцию с помощью компилятора через враппинг.
Допустим есть функция `add(int a, int b)`. При сборке нам надо объявить функцию `__wrap_add(int a, int b)`, указав `-Wl,--wrap=add`, после чего все вызовы `add` будут подменены на `__wrap_add`.